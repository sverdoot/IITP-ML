## Задача

Когда разложение Холецкого совпадает с $LU$-разложением?

#### Решение

Пусть $A \in S^n_{++}$,   $A=LU$, где $L$ - нижнетреугольная с единицами на диагонали, $U$ - верхнетреугольная. Тогда обозначим через $D$ такую диагональную матрицу, что $U = D\hat{L}^{\top}$, причём $\hat{L}$ - нижнетреугольная с единицами на диагонали. Тогда $A = LD\hat{L}^{\top}$.  Так как $A$ - симметричная, $A = \hat{L}DL^{\top}$, причём это  $LU$- разложение $A$.  Из единственности $LU$-разложения матрицы следует, что $L = \hat{L}$. 

Следовательно $A = LDL^{\top}$.  Отсюда получаем разложение Холецкого матрицы $A$ с матрицей $(LD^{1/2}).$ 

Разложение Холецкого совпадает с $LU$- разложением, если 

* $L = LD^{1/2}\Rightarrow D^{1/2} = I$
* $U = D^{1/2}L^{\top} \Rightarrow U = L^{\top}$

Получили необходимое условие вида матрицы $U$ совпадения разложения Холецкого с $LU$- разложением. С другой стороны, очевидно, что оно и достаточное.

Далее можно получить вид матрицы $A$, при котором это выполнено. 

Пусть $A = LL^{\top}$, где $L$ - нижнетр. с единицами на диагонали.

$a_{ij} = \langle l_i, l_j \rangle = \sum_{k=1}^{i-1}a_{ik}a_{jk} + l_{ji}$ при $i < j$    ($l_i$ - $i$ строка матрицы $L$)

Тогда $l_{ji} = a_{ij} - \sum_{k=1}^{i-1}a_{ik}a_{jk} $     при  $i < j$.



$$a_{ii} = 1 + \sum_{k=1}^{i-1}(a_{ik} - \sum_{t=1}^{k-1}a_{kt}a_{it})^2  ~~\forall i =1..n   ~~~~~~~~~(1)$$



Итак, показано, что если , $A=LL^{\top}$ , где $L$ - нижнетреугольная с единицами на диагонали, то диагональный элемент $A$ $a_{ii}$ выражается через элементы $A$ с индексами не больше $i$ по формуле $(1)$.  

Заметим также , что в произведении $LL^{\top}$ диагональный элемент $LL^{\top}$ $a_{ii}$ выражается через элементы $L$ с индексами не больше  $i$. 

Пусть $A \in S^n_{++}, ~a_{ii} = 1 + \sum_{k=1}^{i-1}(a_{ik} - \sum_{t=1}^{k-1}a_{kt}a_{it})^2 ~~\forall i =1..n$.

Произведём $LU$-разложение или разложение Холецкого матрицы $A$  и рассмотрим диагональные элементы нижнетреугольной матрицы $L$ из разложения. Пусть $\exists j:~L_{jj}\ne 1 $. Выберем наименьший из таких $j$. Теперь заметим, что при замене $L_{jj}$ на $1$ свойство матрицы $A$ должно сохраниться для диагональных элементов с индексами $1..j$ (ключевой переход), но этого быть не может, так как при такой замене должен измениться элемент $a_{jj}$. Получили противоречие, значит предположение не верно.

Таким образом разложение Холецкого совпадает с $LU$ разложением $A\in S^n_{++}$ тогда и только тогда, когда $a_{ii} = 1 + \sum_{k=1}^{i-1}(a_{ik} - \sum_{t=1}^{k-1}a_{kt}a_{it})^2  ~~\forall i =1..n $.